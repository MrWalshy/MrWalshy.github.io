<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Docker Bind Mounting</title>
<link rel="stylesheet" href="/css/style.css">
    <nav class="navbar row">
    <button id="toggle" class="hamburger ml-auto"><span></span><span></span><span></span></button>
    <div class="col-12">
        <ul class="nav-content w-100 ml-auto mr-auto">
            <li class="nav-link"><a href="/">Home</a></li>
            <li class="nav-link"><a href="/blog">Blog</a></li>
        </ul>
    </div>
</nav>
    
    
    

</head>
<body>
    
    
    <div class="p-16 w-60 w-md-80 w-sm-90 ml-auto mr-auto">
        <h1>Docker Bind Mounting</h1>
        <p><b>Created on</b>: <time>Wed, 01 Feb 2023 00:00:00 GMT</time></p>
        
        <h2>Tags</h2>
        <ul>
            
                <li>
                    <a href="/blog/tag/docker">Docker</a>
                </li>
            
        </ul>
        <h2>Allowing Docker access to the file system with a Bind Mount</h2>
<p>Docker is capable of sharing the hosts file system, and the networking stack, with containers. This is useful as the data a container needs
might not reside in the image your container is created from.</p>
<p>In this example, we create a <strong>Nginx</strong> server to serve a website from the hosts file system. We do this by attaching a <strong>volume</strong>
to the container when we start it. Let's create a location on the Docker host to contain our site:</p>
<pre><code class="language-sh">sudo mkdir /srv/www
echo &quot;&lt;h1&gt;Hello world&lt;/h1&gt;&quot; &gt; /srv/www/index.html
sudo chmod -R 755 /srv/www
</code></pre>
<blockquote>
<p><code>/srv</code> is the directory recommended by the <a href="https://tldp.org/LDP/Linux-Filesystem-Hierarchy/html/srv.html">Unix File System Hierarchy spec</a>.</p>
</blockquote>
<h2>Running a container with a volume</h2>
<p>The <code>docker run</code> command is useful for quickly starting a container from a given image, we can use the <code>-v</code>/<code>--volume</code>
flag to pass a volume to the container. A <strong>volume</strong> being a mechanism for persisting data generated and used by Docker containers, they
are managed by Docker itself. Volumes can also be shared across multiple containers if needed.</p>
<p>When passing the <code>-v</code> flag to <code>docker run</code>, there is a specific format expected:</p>
<pre><code class="language-sh">docker run -v HOST_MOUNT_PATH:CONTAINER_MOUNT_PATH
</code></pre>
<p>When a single argument is passed to <code>-v</code>, like <code>-v /srv/www</code>, it allocates space and mounts the volume at the specified
location in the container.</p>
<p>When given two arguments, the directory on the host is mounted inside the container at the specified container path. This will
expose any files on the host in the given directory to the container:</p>
<pre><code class="language-sh">docker run -v /srv/www:/usr/share/nginx/html -p 8080:80 -d nginx
</code></pre>
<p>To ensure the container runs in the background, the <code>-d</code> flag for detaching a container was passed to <code>docker run</code>. The <code>-p</code>
flag was used to expose port <code>80</code> in the container to <code>8080</code> on the host system, allowing you to run <code>curl localhost:8080</code>
to query for the <code>index.html</code> file created earlier:</p>
<pre><code class="language-sh">morgan@morgan-server:~$ curl localhost:8080
&lt;h1&gt;Hello world&lt;/h1&gt;
</code></pre>
<p>If we run <code>docker ps</code>, we will see that port <code>8080</code> on the host is being forwarded to port <code>80</code> on the container:</p>
<pre><code class="language-sh">morgan@morgan-server:~$ docker ps
CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                                   NAMES
ecec582a24f3   nginx     &quot;/docker-entrypoint.â€¦&quot;   2 minutes ago   Up 2 minutes   0.0.0.0:8080-&gt;80/tcp, :::8080-&gt;80/tcp   beautiful_mendeleev
</code></pre>
<p>We can then stop and delete our container if it is no longer needed, and the resources on the host shared as a volume
will remain where they are:</p>
<pre><code class="language-sh">morgan@morgan-server:~$ docker stop beautiful_mendeleev
beautiful_mendeleev
morgan@morgan-server:~$ docker rm beautiful_mendeleev
beautiful_mendeleev
</code></pre>
<p>If we type <code>docker volume ls</code>, we will not have any volumes present. This is because the volume created before was a
<strong>bind mount</strong>, this is an ephemeral volume which only exists while the container is bound to the directory
on the host system; it is never given a name by default. When bind mounting, it is important to always specify an absolute path for the host machines directory
that is being mounted in the container; if the file or directory does not exist on the host, it will be created automatically
by Docker.</p>

    </div>


    
    <script src="/scripts/nav.js"></script>

</body>
</html>