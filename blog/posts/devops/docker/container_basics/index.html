<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Docker intro</title>
<link rel="stylesheet" href="/css/style.css">
    <nav class="navbar row">
    <button id="toggle" class="hamburger ml-auto"><span></span><span></span><span></span></button>
    <div class="col-12">
        <ul class="nav-content w-100 ml-auto mr-auto">
            <li class="nav-link"><a href="/">Home</a></li>
            <li class="nav-link"><a href="/blog">Blog</a></li>
        </ul>
    </div>
</nav>
    
    
    <link rel="stylesheet" href="/css/theme/prism-atom-dark.css" />

</head>
<body>
    
    
    <div class="p-16 w-60 w-md-80 w-sm-90 ml-auto mr-auto">
        <h1>Docker intro</h1>
        <p><b>Created on</b>: <time>Tue, 31 Jan 2023 00:00:00 GMT</time></p>

        
            <div class="row w-100">
                <div class="col-5 col-sm-12">
                    <img 
                        src="/assets/images/devops/docker-whale.png" 
                        alt="thumbnail image" 
                    />
                </div>
        
        
        <div class="col-7 col-sm-12 pl-16 pl-sm-0">
        <h2>Tags</h2>
        <ul>
            
                <li>
                    <a href="/blog/tag/docker">Docker</a>
                </li>
            
        </ul>
        </div></div>

        <hr />

        <h1>A Docker introduction</h1>
<blockquote>
<p>These notes assume you have Docker installed. These notes where written using Docker version 20.10.23, build 7155243</p>
</blockquote>
<p>Docker is a containerisation technology used to package applications as lightweight, portable container images. These images contain the application alongside the gubbins needed
to make it work, gubbins includes things like the OS, networking, configurations, etc... A container is not a virtual machine though, they instead share a Linux kernel that the
Docker host has access to; this makes containers use less resources, and thus be more efficient.</p>
<h2>Simple test</h2>
<p>If you installed Docker following the instructions on the Docker website, you have likely done this step. We can quickly spin up a container with the command:</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">docker</span> run hello-world</code></pre>
<p>If all went well, Docker will not find an image on the local system. This will force Docker to search its registered registry, by default this is Docker Hub. If everything is setup correctly and you have a network connection, the image
will be pulled down from Docker Hub and then run. The following will <code>Hello from Docker!</code> message will then show:</p>
<pre class="language-sh"><code class="language-sh">Hello from Docker<span class="token operator">!</span><br>This message shows that your installation appears to be working correctly.<br><br>To generate this message, Docker took the following steps:<br> <span class="token number">1</span>. The Docker client contacted the Docker daemon.<br> <span class="token number">2</span>. The Docker daemon pulled the <span class="token string">"hello-world"</span> image from the Docker Hub.<br>    <span class="token punctuation">(</span>amd64<span class="token punctuation">)</span><br> <span class="token number">3</span>. The Docker daemon created a new container from that image <span class="token function">which</span> runs the<br>    executable that produces the output you are currently reading.<br> <span class="token number">4</span>. The Docker daemon streamed that output to the Docker client, <span class="token function">which</span> sent it<br>    to your terminal.<br><br>To try something <span class="token function">more</span> ambitious, you can run an Ubuntu container with:<br> $ <span class="token function">docker</span> run <span class="token parameter variable">-it</span> ubuntu <span class="token function">bash</span><br><br>Share images, automate workflows, and <span class="token function">more</span> with a <span class="token function">free</span> Docker ID:<br> https://hub.docker.com/<br><br>For <span class="token function">more</span> examples and ideas, visit:<br> https://docs.docker.com/get-started/</code></pre>
<h2>Getting help</h2>
<p>The <code>docker</code> command comes with help available, after any command pass the <code>--help</code> flag instead of its normal input to see the help information for that command.</p>
<h2>Viewing and re-attaching containers</h2>
<p>The <code>docker ps</code> command is used to list running containers. If you have followed from the start, your terminal will output the following when you run the command:</p>
<pre class="language-sh"><code class="language-sh">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</code></pre>
<blockquote>
<p>Another way of listing running containers is with <code>docker container ls</code></p>
</blockquote>
<p>It's quite empty... This is because we do not have any containers running, the <code>hello-world</code> container image from before was started, it executed its code and then shut down. If we use <code>docker ps -a</code> or <code>docker container ls -a</code>, we can see the <code>hello-world</code> container:</p>
<pre class="language-sh"><code class="language-sh">CONTAINER ID   IMAGE                     COMMAND                  CREATED         STATUS                      PORTS     NAMES<br>874ab39f8c8b   hello-world               <span class="token string">"/hello"</span>                 <span class="token number">6</span> minutes ago   Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">6</span> minutes ago              optimistic_moore</code></pre>
<blockquote>
<p>The <code>-a</code> flag to <code>docker ps</code> is the short-hand flag for the long-form <code>--all</code>.</p>
</blockquote>
<p>Each column represents some data describing a container:</p>
<ul>
<li><strong>CONTAINER ID</strong>: A unique identifier for the container</li>
<li><strong>IMAGE</strong>: The name of the image used for the container</li>
<li><strong>COMMAND</strong>: The command executed when the container was started</li>
<li><strong>CREATED</strong>: How long ago the container was created</li>
<li><strong>STATUS</strong>: Indicates the current status of the container</li>
<li><strong>PORTS</strong>: Ports the container exposes to its host system</li>
<li><strong>NAMES</strong>: A randomised name given to a container, names can also be set manually</li>
</ul>
<p>The <code>hello-world</code> container has an <code>Exited</code> status, with an indicated time elapsed since it exited. In parenthesis is an exit code, <code>(0)</code> is indicating a clean exit without error. Try running <code>docker run hello-world</code> to run the <code>hello-world</code> image again, then run <code>docker ps -a</code> again. You should see that there are now multiple containers with the same image:</p>
<pre class="language-sh"><code class="language-sh">CONTAINER ID   IMAGE                     COMMAND                  CREATED          STATUS                      PORTS     NAMES<br>3750a4e5e134   hello-world               <span class="token string">"/hello"</span>                 <span class="token number">3</span> seconds ago    Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">3</span> seconds ago              elegant_mcnulty<br>874ab39f8c8b   hello-world               <span class="token string">"/hello"</span>                 <span class="token number">12</span> minutes ago   Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">12</span> minutes ago             optimistic_moore</code></pre>
<p>This is because <code>docker run</code> will not reuse an existing container unless you specify the containers name or ID. We can reattach to a container then by using the <code>docker start</code> command and passing it the <code>--attach</code> flag with the name of a container, I use <code>elegant_mcnulty</code> like so in this example:</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">docker</span> start <span class="token parameter variable">--attach</span> elegant_mcnulty</code></pre>
<blockquote>
<p><code>docker start</code> is just an alias for <code>docker container start</code>.</p>
</blockquote>
<h3>Filtering results</h3>
<p>We can filter the results returned by <code>docker ps</code> by passing the <code>--filter</code> flag, running <code>sudo docker ps -a --filter name=elegant_mcnulty</code> would return:</p>
<pre class="language-sh"><code class="language-sh">CONTAINER ID   IMAGE                     COMMAND                  CREATED          STATUS                      PORTS     NAMES<br>3750a4e5e134   hello-world               <span class="token string">"/hello"</span>                 <span class="token number">3</span> seconds ago    Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">3</span> seconds ago              elegant_mcnulty</code></pre>
<p>This is useful if you have lots of containers on your system. The command can filter by specifying what to filter on, we would pass <code>id=xxx</code> for filtering on a container ID or <code>port</code> for filtering on a specific port.</p>
<h2>Deleting containers</h2>
<p>In the previous section, there was two containers left over from the <code>hello-world</code> image:</p>
<pre class="language-sh"><code class="language-sh">CONTAINER ID   IMAGE                     COMMAND                  CREATED          STATUS                          PORTS     NAMES<br>3750a4e5e134   hello-world               <span class="token string">"/hello"</span>                 <span class="token number">5</span> minutes ago    Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> About a minute ago             elegant_mcnulty<br>874ab39f8c8b   hello-world               <span class="token string">"/hello"</span>                 <span class="token number">18</span> minutes ago   Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">18</span> minutes ago                 optimistic_moore</code></pre>
<p>We will use the <code>docker rm &lt;CONTAINER_NAME/ID&gt;</code> command to remove them:</p>
<pre class="language-sh"><code class="language-sh">morgan@morgan-server:~$ <span class="token function">docker</span> <span class="token function">rm</span> elegant_mcnulty<br>elegant_mcnulty<br><br>morgan@morgan-server:~$ <span class="token function">docker</span> <span class="token function">rm</span> optimistic_moore<br>optimistic_moore<br><br>morgan@morgan-server:~$ <span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span><br>CONTAINER ID   IMAGE                     COMMAND                  CREATED        STATUS                      PORTS     NAMES</code></pre>
<p>After deleting a container, its name will be echoed to standard out. Running <code>docker ps -a</code> after deleting the containers reveals they no longer exist.</p>
<blockquote>
<p>We can force the removal of a stubborn container by passing the <code>-f</code>/<code>--force</code> flag to <code>docker rm</code>.</p>
</blockquote>
<h2>Interactive containers</h2>
<p>The following example uses the command from the <code>hello-world</code> image output:</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">docker</span> run <span class="token parameter variable">-it</span> ubuntu <span class="token function">bash</span></code></pre>
<blockquote>
<p><code>docker run</code> is short for <code>docker container run</code></p>
</blockquote>
<p>The <code>docker run</code> command can run an image, specifically the command assigned to the image in a new container. We can also use it to connect to the terminal, in an interactive fashion. The <code>-i</code> flag is short for exactly that, <code>--interactive</code> while <code>-t</code> is short for <code>--tty</code>... This will <em>Allocate a pseudo-TTY</em> according to <code>docker run --help</code>, a <code>tty</code> being a <strong>teletypewriter</strong>... kind of. In this day and age, <code>tty</code> is used to refer to how Unix/Linux systems handle terminal IO. By default, the <code>docker run</code> command outputs the containers standard out to the hosts standard out, wherever that is currently pointing. Adding <code>-i</code> adds a standard input stream to the container, mapped to the host. Combining <code>-i</code> with <code>-t</code>, which adds a terminal driver by the way, will then allow you to interact with the containers OS.</p>
<p>After running the command, it will download the <code>ubuntu:default</code> image from Docker Hub and then execute the command <code>bash</code> inside of it to launch the bash shell. The output will look something like the following:</p>
<pre class="language-sh"><code class="language-sh">morgan@morgan-server:~$ <span class="token function">docker</span> run <span class="token parameter variable">-it</span> ubuntu <span class="token function">bash</span><br>Unable to <span class="token function">find</span> image <span class="token string">'ubuntu:latest'</span> locally<br>latest: Pulling from library/ubuntu<br>677076032cca: Pull complete <br>Digest: sha256:f05532b6a1dec5f7a77a8d684af87bc9cd1f2b32eab301c109f8ad151b5565d1<br>Status: Downloaded newer image <span class="token keyword">for</span> ubuntu:latest<br>root@6d85a26869f2:/<span class="token comment"># </span></code></pre>
<p>We are now inside the container, with the last line of the above example showing us as the <code>root</code> user of the host container with the ID of <code>6d85a26869f2</code>. We can execute commands as if we are on another Linux OS, because we are in a way, but inside of a container image:</p>
<pre class="language-sh"><code class="language-sh">root@6d85a26869f2:/<span class="token comment"># ls</span><br>bin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</code></pre>
<p>If we type <code>exit</code> and leave the container, it will shut down. Run <code>docker ps -a</code> to see this:</p>
<pre class="language-sh"><code class="language-sh">CONTAINER ID   IMAGE                     COMMAND                  CREATED         STATUS                      PORTS     NAMES<br>6d85a26869f2   ubuntu                    <span class="token string">"bash"</span>                   <span class="token number">3</span> minutes ago   Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">3</span> seconds ago              magical_keller</code></pre>
<h2>Running a container in the background</h2>
<p>If we don't want to immediately enter a container, but do want it up and running, we can pass the <code>-d</code> and <code>-it</code> flag to <code>docker run</code>:</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">docker</span> run <span class="token parameter variable">-dit</span> ubuntu <span class="token function">bash</span></code></pre>
<p>The <code>-d</code>, or <code>--detached</code> in long form, flag will detach a container from the current terminal and run it in the background. We also passed <code>-i</code> and <code>-t</code> to make sure we can attach to the container stdin and stdout later on.</p>
<pre class="language-sh"><code class="language-sh">morgan@morgan-server:~$ <span class="token function">docker</span> run <span class="token parameter variable">-dit</span> ubuntu <span class="token function">bash</span><br>13a869e58b46fe13b4c77b833d7d6ee02ea4804d8ac84aa0785bc23ea6eb00a9</code></pre>
<p>The output is the <code>CONTAINER ID</code> that we would see in short-form as output of the <code>docker ps -a</code> command:</p>
<pre class="language-sh"><code class="language-sh">CONTAINER ID   IMAGE                     COMMAND                  CREATED          STATUS                      PORTS     NAMES<br>75f1df14c58b   ubuntu                    <span class="token string">"bash"</span>                   <span class="token number">4</span> minutes ago    Up <span class="token number">4</span> minutes                          beautiful_johnson<br>6d85a26869f2   ubuntu                    <span class="token string">"bash"</span>                   <span class="token number">12</span> minutes ago   Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">9</span> minutes ago              magical_keller</code></pre>
<p>The container we just created has a <code>STATUS</code> of <code>Up 4 minutes</code>, indicating the container has been up for 4 minutes. Run <code>docker top &lt;CONTAINER_NAME/ID&gt;</code> to see what is currently happening inside the container, it specifically lists the running processors:</p>
<pre class="language-sh"><code class="language-sh">morgan@morgan-server:~$ <span class="token function">docker</span> <span class="token function">top</span> beautiful_johnson<br><span class="token environment constant">UID</span>                 PID                 <span class="token environment constant">PPID</span>                C                   STIME               TTY                 TIME                CMD<br>root                <span class="token number">10050</span>               <span class="token number">10029</span>               <span class="token number">0</span>                   <span class="token number">23</span>:52               ?                   00:00:00            <span class="token function">bash</span></code></pre>
<h3>Attaching to a detached container</h3>
<p>To attach a container that we have detached from, use the <code>docker attach &lt;CONTAINER_NAME/ID&gt;</code> command:</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">docker</span> attach beautiful_johnson<br>root@75f1df14c58b:/<span class="token comment"># </span></code></pre>
<p>As long as the container was started with <code>-it</code>, we should be able to attach successfully and access the containers shell. If you press <code>CTRL-C</code> or type <code>exit</code>, this will terminate the containers <code>bash</code> shell which was started in the <code>run</code> command before:</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">docker</span> run <span class="token parameter variable">-dit</span> ubuntu <span class="token function">bash</span></code></pre>
<p>Press <code>CTRL P</code> and then <code>CTRL Q</code> to detach from the container and return to your host. The Docker CLI will interpret this as the <strong>read escape sequence</strong> and detach you from the container without stopping it. Type <code>docker ps -a</code> to verify this:</p>
<pre class="language-sh"><code class="language-sh">CONTAINER ID   IMAGE                     COMMAND                  CREATED          STATUS                      PORTS     NAMES<br>75f1df14c58b   ubuntu                    <span class="token string">"bash"</span>                   <span class="token number">5</span> minutes ago    Up <span class="token number">5</span> minutes                          beautiful_johnson<br>6d85a26869f2   ubuntu                    <span class="token string">"bash"</span>                   <span class="token number">26</span> minutes ago   Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">23</span> minutes ago             magical_keller</code></pre>
<p>The <code>beautiful_johnson</code> container is still up and running, so we could re-attach if we wanted to.</p>
<h2>Stopping a detached container</h2>
<p>If you find yourself needing to stop a container, the <code>docker stop &lt;COONTAINER_NAME/ID&gt;</code> command will help you out - <code>docker stop</code> is short for <code>docker container stop</code>. This will stop the running container and print its name to the console when it is done:</p>
<pre class="language-sh"><code class="language-sh">morgan@morgan-server:~$ <span class="token function">docker</span> stop beautiful_johnson<br>beautiful_johnson</code></pre>
<p>We can then delete the container using the <code>docker rm</code> command. If there are multiple containers to delete, specify them as a space separated list:</p>
<pre class="language-sh"><code class="language-sh">morgan@morgan-server:~$ <span class="token function">docker</span> <span class="token function">rm</span> beautiful_johnson magical_keller<br>beautiful_johnson<br>magical_keller</code></pre>
<h2>Naming a container</h2>
<p>When running a container, it is automatically given a generated name. We can override this and supply our own name by passing the <code>--name</code> flag and an argument to the flag to the <code>docker run</code> command:</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">docker</span> run <span class="token parameter variable">-dit</span> <span class="token parameter variable">--name</span> my_container ubuntu <span class="token function">bash</span></code></pre>
<p>A quick <code>docker ps</code> reveals that the created container has the name <code>my_container</code>, specified in the command above:</p>
<pre class="language-sh"><code class="language-sh">CONTAINER ID   IMAGE                     COMMAND                  CREATED         STATUS                      PORTS     NAMES<br>64fec43342f4   ubuntu                    <span class="token string">"bash"</span>                   <span class="token number">4</span> seconds ago   Up <span class="token number">3</span> seconds                          my_container</code></pre>


        
        <script src="https://giscus.app/client.js"
                data-repo="MrWalshy/MrWalshy.github.io"
                data-repo-id="R_kgDOHQucNw"
                data-category="Announcements"
                data-category-id="DIC_kwDOHQucN84CUeyo"
                data-mapping="pathname"
                data-strict="1"
                data-reactions-enabled="1"
                data-emit-metadata="0"
                data-input-position="top"
                data-theme="preferred_color_scheme"
                data-lang="en"
                data-loading="lazy"
                crossorigin="anonymous"
                async>
        </script>
    </div>


    
    <script src="/scripts/nav.js"></script>

</body>
</html>